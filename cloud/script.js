let streetView = [
  [
    {
      title: "4 Hackworth St, Rainhill Way, London, England",
      coordinate: `51° 31' 33.012" N<br>0° 1' 8.6" W`,
      cloud: "[After a satisfying flight meal, excited about arrival]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2Fshort_4%20Hackworth%20St%2C%20Rainhill%20Way%2C%20London%2C%20England.mp4",
      caption:
        "The old man is sitting in a daze on the balcony again, frowning as usual",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016668/original_d5e06b9e304c66d511958eb2b0a248e7.png?1637137576?bc=0"
    },
    {
      caption: "Is this 66 or 99?",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016667/original_6d93a4f929f1854d8744f2f9e2478571.png?1637137576?bc=0"
    },
    {
      caption: "The sun was shining, even a little dazzling",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016665/original_e30f800562ee87e85b9408b7351ef593.png?1637137575?bc=0"
    },
    {
      caption:
        "There's a guy in the laundry, playing on his phone waiting for his clothes in washing",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016664/original_d31a37abb5f125fd2f4bdf60fa1a6760.png?1637137571?bc=0"
    },
    {
      caption: "The wooden frames make the reflection looks like a painting",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016663/original_dd993c368456f7a9729cb62905a3dacc.png?1637137565?bc=0"
    },
    {
      caption:
        "The wheel sticking out over the railings, casting its circular shadow on the wall like a clock.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016662/original_70f610f9b6825a593d44f418e31f5435.png?1637137571?bc=0"
    },
    {
      caption: "Another plane flying by, and the rumble never stopped here",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016661/original_521b8d07e02c1c745a52a6481f6b714c.png?1637137559?bc=0"
    }
  ],
  [
    {
      title: "14 Fenchurch Ave London, England",
      coordinate: `51° 30' 45" N<br>0° 4' 50.52" W`,
      cloud: "[Just woke up from a sleep, excited about arrival]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2F14%20Fenchurch%20Ave%20London%2C%20England.mp4",
      caption:
        "Gate 3 was wrapped in green vines, a man standing in front of it looking around.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016719/original_f14fd72e53c18a0a55a3c45591f9ab5e.png?1637138067?bc=0"
    },
    {
      caption:
        "A worker is standing on top of a towering red forklift, looking down.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016717/original_d4c23c300f30163120a5a298f6224b33.png?1637138065?bc=0"
    }
  ],
  [
    {
      title: "Castle Baynard, London, England",
      coordinate: `51° 30' 38.778" N<br>0° 6' 25.62" W`,
      cloud:
        "[Trying to catch a glimpse of the ground through the cracks in the clouds]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2Fshort_Castle%20Baynard%2C%20London%2C%20England.mp4",
      caption: "A coffee cup was left on the ground, in an autumn day.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016726/original_30c1d95a64f6a6748c9043caae87e16c.png?1637138119?bc=0"
    }
  ],
  [
    {
      title: "610 King's Road, london, England",
      coordinate: `51° 28' 42.552" N<br>0° 11' 21.45" W`,
      cloud:
        "[The plane began to bumping, a gentle female voice announced <br>that everyone should fasten their seat belts]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2F%20short_610%20King's%20Road%2C%20london%2C%20England.mp4",
      caption: "There's a blackbird in the sky – could also be a plastic bag.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016730/original_e59be574a6ae6aded96fee79f3125bd9.png?1637138151?bc=0"
    },
    {
      caption: "The luxury bathtubs are 50% off.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016729/original_0a8692199278d1ed44d4348a0e99452b.png?1637138151?bc=0"
    },
    {
      caption: "A plane was flying across the sky, was I sitting on it?",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016728/original_49391969485e1f440f9a0f6a4de921e0.png?1637138148?bc=0"
    },
    {
      caption: "The clock pointing at 11:27, It's should be a morning.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016727/original_a1200f16478138e2ab581ff14d8044ed.png?1637138148?bc=0"
    }
  ],
  [
    {
      title: "Balochistan, Pakistan",
      coordinate: `28° 41' 13.668" N<br>66° 9' 48.73" E`,
      cloud:
        "[Passing clouds that looks like a snow field, an unusual sight for the summer time]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2Fshort_Balochistan%2C%20Pakistan.mp4",
      caption:
        "A piece of red fabric had been left on a rocky knoll in the desert.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016967/original_80efa179b5c7a346a39b4210883a4ca9.png?1637140711?bc=0"
    },
    {
      caption:
        "Three men in robes with two motorcycles were standing in a desert.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016966/original_2fa3386990eee731458916032a1f0306.png?1637140708?bc=0"
    },
    {
      caption:
        "A round, pale blue stone stood out from a dark pile of gravel and sand.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016965/original_ee46d49ddb0c2a1087d75348fb6d7d5e.png?1637140708?bc=0"
    },
    {
      caption:
        "The blue-grey stones, the scattered clumps of grass, <br>the mountains in the distance, the sunlight falling down.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016964/original_8897603e810a602789a56f4cd0985bed.png?1637140707?bc=0"
    }
  ],
  [
    {
      title: "Masiran-ro, Jung-gu, Incheon, South Korea",
      coordinate: `40° 57' 12.96" N<br>73° 26' 19.68" W`,
      cloud:
        "[Staring outside, wondering where am I at, imagine my glance <br>is sweping though trees, rivers, villages, people passing]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2Fshort_Masiran-ro%2C%20Jung-gu%2C%20Incheon%2C%20South%20Korea.mp4",
      caption:
        "A man with a cart stood in the middle of the road, <br>wearing a turban and mask, looking into the camera.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14017071/original_76abb95e3e767340b511601a9d4e7d8d.png?1637141607?bc=0"
    },
    {
      caption:
        "A puddle by the side of the road. looks like just rained, <br>though the day was clear.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14017070/original_eb04e5cb0aaeeb3de551764c22d9d440.png?1637141606?bc=0"
    }
  ],
  [
    {
      title: "197 N 7th St Saddle Brook, New Jersey",
      coordinate: `40° 53' 26.16" N<br>74° 5' 48.48" W`,
      cloud:
        "[It's near the midnight, the 'welcome to the US' announcements <br>and music began to play, countless lights lit up the ground]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2Fshort_197%20N%207th%20St%20Saddle%20Brook%2C%20New%20Jersey.mp4",
      caption: "A short-haired woman on then lawn.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016724/original_a7f775abf14647fe58d547f09ec294db.png?1637138100?bc=0"
    },
    {
      caption: "A plane flew across the sky.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016723/original_37d362f0561d34e2bc7c70b30a2a42a7.png?1637138098?bc=0"
    }
  ],
  [
    {
      title: "3054 Lowell Ave, Wantagh, NY, US",
      coordinate: `40° 40' 22.92" N<br>73° 31' 4.05" W`,
      cloud:
        "[Staring out the window at the clouds, <br>feeling a little nervous about entering quarantine in a few hours.]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2Fshort_3054%20Lowell%20Ave%2C%20Wantagh%2C%20NY%2C%20US.mp4",
      caption: "The basement was crisscrossed with plumbing.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016713/original_5bba75db23e85232a517ccfcc80bc2f0.png?1637137977?bc=0"
    },
    {
      caption: "The cows always look so happy",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016712/original_22f2ba0a1290224caaa61817d6a46147.png?1637137976?bc=0"
    },
    {
      caption: "Animals and people have equal status in the family",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016711/original_75bace00d31849d5953b295236becbf8.png?1637137975?bc=0"
    },
    {
      caption: "It's almost eight o 'clock",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016710/original_04d1bcd90a7c4c89daf6dd53cd090292.png?1637137978?bc=0"
    },
    {
      caption: "Another cow – in a dress.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016709/original_02cdc00876af3676bd32da7f83b828bc.png?1637137975?bc=0"
    },
    {
      caption: "The cow is the family mascot",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016708/original_df1eef6131b0022251f30739f18fa440.png?1637137973?bc=0"
    },
    {
      caption: "There are cute animals everywhere in this house",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016707/original_429d2552f028e9bc0d841b351904f41d.png?1637137972?bc=0"
    },
    {
      caption: "A gun was found in the basement.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016706/original_32520781b586040797d7eccecc3cf431.png?1637137972?bc=0"
    },
    {
      caption:
        "The reflection of a round lamp fell right in the middle of the fan window like a pearl in a shell",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016705/original_9c14b8dc9ad147e86484582a62813d2b.png?1637137972?bc=0"
    },
    {
      caption: "Everyone laughs every time water pours out of this cow's face",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016704/original_5a0c5153c2a1a0fa0c8043231162d0ab.png?1637137973?bc=0"
    },
    {
      caption: "A train passed between the eaves.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016703/original_4e960e8288214202a7a90773c9b9047a.png?1637137973?bc=0"
    }
  ],
  [
    {
      title: "1344 Briard St, Wanatagh, NY, US",
      coordinate: `40° 41' 22.92" N<br>73° 30' 15.12" W`,
      cloud: "[Breathing constrainedly in a tight mask]",
      cloudUrl:
        "https://cdn.glitch.me/94e11b05-aa9e-4658-8375-6ee92e47a8ae%2Fshort_1344%20Briard%20St%2C%20Wanatagh%2C%20NY%2C%20US.mp4",
      caption: "Through the camera, memory become pixelated",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016695/original_a4a9b697028594d03119be72b38f0649.png?1637137904?bc=0"
    },
    {
      caption:
        "All the roadside bushes in the neighborhood had been carefully pruned,",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016694/original_28915c20394bd410a838d177012e7187.png?1637137904?bc=0"
    },
    {
      caption: "except for a wild flower growing under the eaves.",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016693/original_819d0f253b7b15ca4813d2bf50165530.png?1637137902?bc=0"
    },
    {
      caption:
        "They had planted quite a few trees here, <br>and a small one had just been transplanted to the lawn of this strange neighborhood",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016692/original_d58112ae65af4c5421441cfac7dca525.png?1637137902?bc=0"
    },
    {
      caption: "There is a house with a silent bell hanging from its chimney",
      imageUrl:
        "https://d2w9rnfcy7mm78.cloudfront.net/14016691/original_158e522e59366422066828b8f075abd5.png?1637137901?bc=0"
    }
  ]
];
import Effect from "./Effect.js";

const canvas = document.getElementById("canvas1");
const ctx = canvas.getContext("2d");
let video = document.querySelector("video");

// Get Random Street View Image
let navs = document.querySelectorAll("nav a");
let imageWrapper = document.querySelector("#image-wrapper").firstElementChild;
let captionHolder = document.querySelector("#caption");
let caption = "";

let index = new Array(navs.length);
let workingArr = new Array(navs.length);

for (let i = 0; i < navs.length; i++) {
  index[i] = 0;
  workingArr[i] = [...streetView[i]];

  if (streetView[i].length > 1) {
    navs[i].addEventListener("mouseenter", e => {
      console.log("mouseneter");
      if (workingArr[i].length > 1) {
        index[i] = getRandNum(workingArr[i]);
        if (e.target.className === "location") {
          resetCaptions();
        }
        newStreetView(i, index[i]);
        workingArr[i].splice(index[i], 1);
      } else {
        index[i] = 0;
        if (e.target.className === "location") {
          resetCaptions();
        }
        newStreetView(i, index[i]);
        workingArr[i] = [...streetView[i]].filter(
          x => !workingArr[i].includes(x)
        );
      }
    });
  } else {
    navs[i].addEventListener("mouseenter", e => {
      if (e.target.className === "location") {
        resetCaptions();
      }
      newStreetView(i, 0);
    });
  }

  navs[i].addEventListener("mouseleave", () => {
    removeStreetView(i, index[i]);
  });
}

function getRandNum(workingArr) {
  return Math.floor(Math.random() * workingArr.length);
}

function newStreetView(i, index) {
  imageWrapper.src = workingArr[i][index].imageUrl;
  imageWrapper.style.webkitTransition = "-webkit-filter 3s";
  imageWrapper.style.webkitFilter =
    "contrast(100%) brightness(100%) opacity(100%)";
  video.src = streetView[i][0].cloudUrl;
  video.setAttribute("crossorigin", "anonymous");
  navs[i].innerHTML = streetView[i][0].coordinate;
  navs[i].className = "coordinate";
  captionHolder.innerHTML = streetView[i][0].cloud;
  captionHolder.className = "cloud";
  caption = workingArr[i][index].caption;
}

function removeStreetView(i, index) {
  // imageWrapper.style.webkitTransition = "-webkit-filter 3s";
  // imageWrapper.style.webkitFilter = "contrast(600%) brightness(800%) opacity(0%)";
  captionHolder.innerHTML = caption;
  captionHolder.className = "caption";
  // imageWrapper.src = ''
  // navs[i].textContent = "✕"
  // navs[i].className = "location"
}

function resetCaptions() {
  for (let nav of navs) {
    nav.innerHTML = "⚑";
    nav.className = "location";
    console.log("reset captions");
  }
}

video.addEventListener("loadedmetadata", function(e) {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

let effect = new Effect(navs, ctx, video);

/*

function random() {
  return Math.floor(Math.random() * 100)
}

function ratio(e) {
  return (e.clientX + e.clientY) / (window.innerWidth + window.innerHeight)
}

let randContrast = 100
let randBrightness = 100
let randopacity = 100
window.setInterval(() => { 
  // randContrast = random() * 6
  // randBrightness = random() * 8
  // randopacity = random()
}, 50)

let bg = document.querySelector("#bg")
bg.addEventListener('mousemove', (e) => {
  console.log(randBrightness + "," + randopacity)
  randContrast = ratio(e) * 600
  randBrightness = ratio(e) * 800
  randopacity = ratio(e) * 100
  imageWrapper.style.webkitFilter = `contrast(600%) brightness(${randBrightness}%) opacity(${randopacity}%)`;
  imageWrapper.style.webkitTransition = "-webkit-filter 0.1s";
  console.log(imageWrapper.style.webkitFilter)
})

*/

// Cursor With Coordinates

// let coordinate = document.getElementById("coordinate")

// document.addEventListener('mousemove', (e) => {
//   let axisX = e.clientX
//   let axisY = e.clientY
//   document.getElementById("axisX").style.left = axisX + "px"
//   document.getElementById("axisY").style.top = axisY + "px"
//   for (let i = 0; i < navs.length; i++) {
//     navs[i].addEventListener('mousemove', () => {
//       coordinate.style.left = axisX + 5 + "px"
//       coordinate.style.top = axisY - 10 + "px"
//       coordinate.textContent = streetView[i][0].coordinate
//     })
//     navs[i].addEventListener('mouseleave', () => {
//       coordinate.textContent = ""
//     })
//   }

// })
